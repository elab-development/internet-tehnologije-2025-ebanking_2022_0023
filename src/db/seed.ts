import "dotenv/config";
import { db } from "./index";
import {
  users,
  accounts,
  transactions,
  currencies,
  managerClients,
} from "./schema";
import bcrypt from "bcrypt";

const seedCurrencies = [
  {
    id: "550e8400-e29b-41d4-a716-446655440001",
    code: "RSD",
    name: "Srpski dinar",
    symbol: "RSD",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440002",
    code: "EUR",
    name: "Evro",
    symbol: "€",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440003",
    code: "GBP",
    name: "Britanska funta",
    symbol: "£",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440004",
    code: "USD",
    name: "Američki dolar",
    symbol: "$",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440005",
    code: "JPY",
    name: "Japanski jen",
    symbol: "¥",
  },
];

const seedUsers = [
  {
    id: "550e8400-e29b-41d4-a716-446655440010",
    email: "admin@bank.rs",
    password: "admin123",
    firstName: "Ana",
    lastName: "Adminić",
    phone: "+381641111111",
    nationalId: "1111111111111",
    dateOfBirth: new Date("1985-03-20"),
    sex: "Ženski" as const,
    role: "ADMIN" as const,
    active: true,
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440011",
    email: "manager@bank.rs",
    password: "manager123",
    firstName: "Milan",
    lastName: "Menadžerović",
    phone: "+381642222222",
    nationalId: "2222222222222",
    dateOfBirth: new Date("1988-07-15"),
    sex: "Muški" as const,
    role: "MANAGER" as const,
    active: true,
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440012",
    email: "marko.petrovic@email.com",
    password: "test123",
    firstName: "Marko",
    lastName: "Petrović",
    phone: "+381641234567",
    nationalId: "1234567890123",
    dateOfBirth: new Date("1990-05-15"),
    sex: "Muški" as const,
    role: "CLIENT" as const,
    active: true,
  },
];

const seedAccounts = [
  {
    id: "550e8400-e29b-41d4-a716-446655440020",
    accountNo: "160-0000012345678-91",
    balance: 125430.5,
    createdAt: new Date("2020-01-10"),
    status: "Aktivan" as const,
    clientID: "550e8400-e29b-41d4-a716-446655440012",
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440021",
    accountNo: "160-0000087654321-15",
    balance: 3250.75,
    createdAt: new Date("2021-06-20"),
    status: "Aktivan" as const,
    clientID: "550e8400-e29b-41d4-a716-446655440012",
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
];

const seedTransactions = [
  {
    id: "550e8400-e29b-41d4-a716-446655440030",
    amount: -2500.0,
    timestamp: new Date("2025-02-05T10:30:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "170-0000099999999-22",
    description: "Kirija za stan - Februar 2025",
    status: "Izvršena" as const,
    category: "Stanovanje" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440031",
    amount: -1200.0,
    timestamp: new Date("2025-02-04T14:15:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "180-0000055555555-33",
    description: "Kupovina u Maksiju",
    status: "Izvršena" as const,
    category: "Hrana" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440032",
    amount: 85000.0,
    timestamp: new Date("2025-02-01T09:00:00"),
    accountSrcNo: "190-0000011111111-44",
    accountDestNo: "160-0000012345678-91",
    description: "Plata - Januar 2025",
    status: "Izvršena" as const,
    category: null,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440033",
    amount: -3500.0,
    timestamp: new Date("2025-01-30T18:45:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "160-0000088888888-55",
    description: "Teretana - Godišnja članarina",
    status: "Izvršena" as const,
    category: "Sport" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440034",
    amount: -850.0,
    timestamp: new Date("2025-01-28T20:30:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "160-0000077777777-66",
    description: "Restoran Tri Šešira",
    status: "Izvršena" as const,
    category: "Izlazak" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440035",
    amount: -4200.0,
    timestamp: new Date("2025-01-25T11:20:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "160-0000066666666-77",
    description: "EPS - Račun za struju",
    status: "Izvršena" as const,
    category: "Domaćinstvo" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440036",
    amount: -1500.0,
    timestamp: new Date("2025-01-22T16:00:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "160-0000044444444-88",
    description: "Netflix + Spotify pretplata",
    status: "Izvršena" as const,
    category: "Zabava" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440037",
    amount: -2800.0,
    timestamp: new Date("2025-01-20T13:30:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "160-0000033333333-99",
    description: "Apoteka - Lekovi",
    status: "Izvršena" as const,
    category: "Ostalo" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440038",
    amount: -5000.0,
    timestamp: new Date("2025-02-07T10:30:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "160-0000022222222-00",
    description: "Prenos na devizni račun",
    status: "Na čekanju" as const,
    category: null,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440039",
    amount: -750.0,
    timestamp: new Date("2025-01-18T19:15:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "160-0000011111111-11",
    description: "Bioskop - VIP karte",
    status: "Izvršena" as const,
    category: "Zabava" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440001",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440040",
    amount: -120.5,
    timestamp: new Date("2025-02-06T12:00:00"),
    accountSrcNo: "160-0000087654321-15",
    accountDestNo: "170-0000099999999-22",
    description: "Kupovina na Amazonu",
    status: "Izvršena" as const,
    category: "Ostalo" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440041",
    amount: 500.0,
    timestamp: new Date("2025-02-03T15:30:00"),
    accountSrcNo: "180-0000055555555-33",
    accountDestNo: "160-0000087654321-15",
    description: "Povraćaj novca - refund",
    status: "Izvršena" as const,
    category: null,
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440042",
    amount: -45.0,
    timestamp: new Date("2025-02-02T09:45:00"),
    accountSrcNo: "160-0000087654321-15",
    accountDestNo: "160-0000099999999-44",
    description: "Steam - Igrica",
    status: "Izvršena" as const,
    category: "Zabava" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440043",
    amount: -80.25,
    timestamp: new Date("2025-01-31T17:20:00"),
    accountSrcNo: "160-0000087654321-15",
    accountDestNo: "160-0000088888888-55",
    description: "Kafić - Račun",
    status: "Izvršena" as const,
    category: "Izlazak" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440044",
    amount: -150.0,
    timestamp: new Date("2025-01-29T11:00:00"),
    accountSrcNo: "160-0000087654321-15",
    accountDestNo: "160-0000077777777-66",
    description: "Online kurs - Udemy",
    status: "Neuspešna" as const,
    category: "Ostalo" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440045",
    amount: 1000.0,
    timestamp: new Date("2025-01-26T10:00:00"),
    accountSrcNo: "160-0000012345678-91",
    accountDestNo: "160-0000087654321-15",
    description: "Transfer između računa",
    status: "Izvršena" as const,
    category: null,
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440046",
    amount: -35.5,
    timestamp: new Date("2025-01-24T14:30:00"),
    accountSrcNo: "160-0000087654321-15",
    accountDestNo: "160-0000066666666-77",
    description: "Parking - Mesečna karta",
    status: "Izvršena" as const,
    category: "Ostalo" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
  {
    id: "550e8400-e29b-41d4-a716-446655440047",
    amount: -25.0,
    timestamp: new Date("2025-01-21T16:45:00"),
    accountSrcNo: "160-0000087654321-15",
    accountDestNo: "160-0000055555555-88",
    description: "Dostava hrane - Glovo",
    status: "Izvršena" as const,
    category: "Hrana" as const,
    currencyID: "550e8400-e29b-41d4-a716-446655440002",
  },
];

const hash = await bcrypt.hash("admin123", 10);
const hashManager = await bcrypt.hash("manager123", 10);
const hashClient = await bcrypt.hash("test123", 10);

await db.transaction(async (tx) => {
  await tx.insert(currencies).values(seedCurrencies);

  await tx.insert(users).values([
    {
      ...seedUsers[0],
      password: hash,
      createdAt: new Date(),
    },
    {
      ...seedUsers[1],
      password: hashManager,
      createdAt: new Date(),
    },
    {
      ...seedUsers[2],
      password: hashClient,
      createdAt: new Date(),
    },
  ]);

  await tx.insert(managerClients).values({
    id: "550e8400-e29b-41d4-a716-446655440050",
    managerID: "550e8400-e29b-41d4-a716-446655440011",
    clientID: "550e8400-e29b-41d4-a716-446655440012",
  });

  await tx.insert(accounts).values(seedAccounts);
  await tx.insert(transactions).values(seedTransactions);
});

process.exit(0);
